{% extends 'base.html' %}
{% block content %}
<h2>Run #{{ run.id }} â€” Composite Viewer</h2>

<link rel="stylesheet" href="/static/css/viewer.css" />

<div class="viewer-layout">
  <aside class="viewer-side">
    <div class="group">
      <label for="docSelect">Document</label>
      <select id="docSelect" aria-label="Document"></select>
      <div id="pageLimitWarn" class="warn" hidden>Showing first 10 pages. <button id="overrideLimit">Show all</button></div>
    </div>
    <div class="group">
      <div class="row"><input id="toggleGray" type="checkbox"/> <label for="toggleGray">Grayscale</label></div>
      <div class="row"><input id="toggleNums" type="checkbox"/> <label for="toggleNums">Show BBox Numbers</label></div>
      <label>Overlay Opacity <input id="opacity" type="range" min="0" max="100" value="70"/></label>
    </div>
    <div class="group">
      <label>Parsers</label>
      <div id="parsers"></div>
      <div id="legend" class="legend"></div>
    </div>
    <div class="group">
      <button id="exportBtn">Export Package</button>
    </div>
  </aside>
  <main class="viewer-main">
    <div class="toolbar">
      <button id="prevBtn">Prev</button>
      <span>
        <label for="pageInput">Page</label>
        <input id="pageInput" type="number" min="0" value="0" aria-label="Page index"/>
        / <span id="pageTotal">0</span>
      </span>
      <button id="nextBtn">Next</button>
      <span class="spacer"></span>
      <button id="zoomOut">-</button>
      <button id="zoomReset">100%</button>
      <button id="zoomIn">+</button>
    </div>
    <div id="viewport" class="viewport">
      <div id="canvas" class="canvas">
        <img id="pageImg" alt="page" />
        <svg id="overlay" xmlns="http://www.w3.org/2000/svg"></svg>
      </div>
    </div>
    <section class="bottom-panel">
      <div class="tabs" id="resultTabs"></div>
      <div class="tab-panels" id="resultPanels"></div>
    </section>
  </main>
</div>

<script>
  window.__RUN_ID__ = {{ run.id }};
  window.__VISUAL_INDEX__ = {{ visual_index_json | safe }};
</script>
<script src="/static/js/run_view.js"></script>
{% endblock %}
